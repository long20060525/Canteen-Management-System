#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_DISHES 20
#define MAX_FEEDBACKS 20

// 菜品反馈结构体
typedef struct {
    int score;             // 评分(1-5分)
    char comment[100];     // 评价内容
} Feedback;

// 菜品信息结构体
typedef struct {
    char window[50];       // 窗口名称
    char name[50];         // 菜品名称
    char ingredients[200]; // 食材用料
    char prepTime[20];     // 备菜时间
    char leftover[50];     // 剩菜处理方式
    Feedback feedbacks[MAX_FEEDBACKS]; // 学生反馈数组
    int feedbackCount;     // 反馈数量
    float avgScore;        // 平均评分
} Dish;

int main() {
    FILE *file = fopen("dishes.dat", "wb");
    if (file == NULL) {
        printf("无法创建数据文件！\n");
        return 1;
    }
    
    // 菜品数量
    int dishCount = 20;
    fwrite(&dishCount, sizeof(int), 1, file);
    
    // 创建20组菜品数据
    Dish dishes[MAX_DISHES] = {
        // 窗口1：川菜窗口
        {
            "川菜窗口",
            "麻婆豆腐", 
            "豆腐200g,牛肉末50g,豆瓣酱,花椒", 
            "15分钟", 
            "当日销毁",
            {{4, "麻辣适中"}, {5, "超级下饭"}}, 
            2, 
            4.5f
        },
        {
            "川菜窗口",
            "水煮鱼", 
            "草鱼500g,豆芽,干辣椒,花椒", 
            "25分钟", 
            "冷藏次日再用",
            {{5, "鱼肉鲜嫩"}, {3, "太辣了"}}, 
            2, 
            4.0f
        },
        
        // 窗口2：粤菜窗口
        {
            "粤菜窗口",
            "白切鸡", 
            "三黄鸡1只,姜葱,沙姜", 
            "40分钟", 
            "冷藏保存",
            {{5, "鸡肉很嫩"}, {4, "蘸料好吃"}}, 
            2, 
            4.5f
        },
        {
            "粤菜窗口",
            "叉烧包", 
            "面粉,叉烧肉,蚝油,蜂蜜", 
            "30分钟", 
            "冷冻保存",
            {{3, "馅料偏少"}, {4, "面皮松软"}}, 
            2, 
            3.5f
        },
        
        // 窗口3：面食窗口
        {
            "面食窗口",
            "牛肉拉面", 
            "拉面300g,牛肉片,白萝卜,香菜", 
            "10分钟", 
            "不可留存",
            {{5, "汤头鲜美"}, {5, "面条劲道"}}, 
            2, 
            5.0f
        },
        {
            "面食窗口",
            "炸酱面", 
            "手擀面,五花肉末,甜面酱,黄瓜丝", 
            "12分钟", 
            "当日销毁",
            {{4, "酱料香浓"}, {2, "偏咸"}}, 
            2, 
            3.0f
        },
        
        // 窗口4：健康轻食
        {
            "健康轻食",
            "鸡胸沙拉", 
            "鸡胸肉150g,混合蔬菜,橄榄油", 
            "8分钟", 
            "隔夜禁用",
            {{4, "低卡健康"}, {3, "鸡肉略柴"}}, 
            2, 
            3.5f
        },
        {
            "健康轻食",
            "藜麦饭", 
            "藜麦,糙米,西兰花,胡萝卜", 
            "20分钟", 
            "冷藏保存",
            {{5, "饱腹感强"}, {4, "营养均衡"}}, 
            2, 
            4.5f
        },
        
        // 窗口5：特色小吃
        {
            "特色小吃",
            "煎饼果子", 
            "绿豆面,鸡蛋,薄脆,葱花", 
            "5分钟", 
            "现做现卖",
            {{5, "正宗味道"}, {4, "分量足"}}, 
            2, 
            4.5f
        },
        {
            "特色小吃",
            "章鱼小丸子", 
            "章鱼粒,面糊,照烧酱,木鱼花", 
            "7分钟", 
            "不可留存",
            {{3, "章鱼偏少"}, {4, "外脆里嫩"}}, 
            2, 
            3.5f
        },
        
        // 窗口6：家常菜
        {
            "家常菜窗口",
            "红烧肉", 
            "五花肉500g,冰糖,生抽,老抽,料酒", 
            "45分钟", 
            "冷藏保存",
            {{5, "肥而不腻"}, {4, "入口即化"}}, 
            2, 
            4.5f
        },
        {
            "家常菜窗口",
            "鱼香肉丝", 
            "猪里脊300g,木耳,胡萝卜,青椒", 
            "20分钟", 
            "当日食用",
            {{4, "酸甜可口"}, {3, "肉丝稍老"}}, 
            2, 
            3.5f
        },
        
        // 窗口7：西餐
        {
            "西餐窗口",
            "意大利面", 
            "意面200g,番茄酱,肉末,洋葱", 
            "15分钟", 
            "冷藏保存",
            {{4, "酱汁浓郁"}, {5, "份量足够"}}, 
            2, 
            4.5f
        },
        {
            "西餐窗口",
            "牛排套餐", 
            "牛排150g,土豆泥,西兰花,黑椒汁", 
            "20分钟", 
            "不可留存",
            {{5, "火候刚好"}, {4, "配菜新鲜"}}, 
            2, 
            4.5f
        },
        
        // 窗口8：素食
        {
            "素食窗口",
            "素三鲜饺子", 
            "面粉,香菇,木耳,胡萝卜", 
            "30分钟", 
            "冷冻保存",
            {{4, "皮薄馅大"}, {3, "味道清淡"}}, 
            2, 
            3.5f
        },
        {
            "素食窗口",
            "罗汉斋", 
            "腐竹,香菇,木耳,胡萝卜,荷兰豆", 
            "18分钟", 
            "冷藏保存",
            {{5, "营养丰富"}, {4, "色彩搭配好"}}, 
            2, 
            4.5f
        },
        
        // 窗口9：汤品
        {
            "汤品窗口",
            "玉米排骨汤", 
            "排骨300g,玉米,胡萝卜,枸杞", 
            "60分钟", 
            "冷藏保存",
            {{5, "汤鲜味美"}, {4, "排骨软烂"}}, 
            2, 
            4.5f
        },
        {
            "汤品窗口",
            "西湖牛肉羹", 
            "牛肉末100g,豆腐,香菇,蛋清", 
            "25分钟", 
            "当日食用",
            {{4, "口感顺滑"}, {3, "偏咸"}}, 
            2, 
            3.5f
        },
        
        // 窗口10：甜品
        {
            "甜品窗口",
            "芒果布丁", 
            "芒果200g,牛奶,吉利丁,糖", 
            "120分钟", 
            "冷藏保存",
            {{5, "香甜可口"}, {4, "口感Q弹"}}, 
            2, 
            4.5f
        },
        {
            "甜品窗口",
            "双皮奶", 
            "牛奶500ml,蛋清,糖", 
            "90分钟", 
            "冷藏保存",
            {{4, "奶香浓郁"}, {3, "不够顺滑"}}, 
            2, 
            3.5f
        }
    };
    
    // 写入菜品数据
    for (int i = 0; i < dishCount; i++) {
        fwrite(&dishes[i], sizeof(Dish), 1, file);
    }
    
    fclose(file);
    printf("成功创建 dishes.dat 文件，包含 %d 条菜品数据\n", dishCount);
    
    // 验证文件内容
    printf("\n文件验证:\n");
    FILE *check = fopen("dishes.dat", "rb");
    if (check) {
        int count;
        fread(&count, sizeof(int), 1, check);
        printf("菜品数量: %d\n", count);
        
        for (int i = 0; i < count; i++) {
            Dish dish;
            fread(&dish, sizeof(Dish), 1, check);
            printf("\n菜品 %d: %s - %s (评分: %.1f)\n", 
                   i+1, dish.window, dish.name, dish.avgScore);
            printf("食材: %s\n", dish.ingredients);
        }
        fclose(check);
    } else {
        printf("无法验证文件内容\n");
    }
    
    return 0;
}